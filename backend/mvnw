#!/bin/sh
# Maven Wrapper script

# Find the project base dir
MAVEN_PROJECTBASEDIR="${MAVEN_BASEDIR:-$(cd "$(dirname "$0")" && pwd)}"
MAVEN_OPTS="${MAVEN_OPTS:--Xmx1024m}"

# Download maven-wrapper.jar if it doesn't exist
WRAPPER_JAR="$MAVEN_PROJECTBASEDIR/.mvn/wrapper/maven-wrapper.jar"
WRAPPER_URL="https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.2.0/maven-wrapper-3.2.0.jar"

if [ ! -f "$WRAPPER_JAR" ]; then
    mkdir -p "$(dirname "$WRAPPER_JAR")"
    curl -o "$WRAPPER_JAR" "$WRAPPER_URL" 2>/dev/null || wget -O "$WRAPPER_JAR" "$WRAPPER_URL"
fi

# Use system Maven if available, otherwise use wrapper
if command -v mvn >/dev/null 2>&1; then
    exec mvn "$@"
else
    exec java $MAVEN_OPTS -jar "$WRAPPER_JAR" "$@"
fi
